{"id":"gdoc-2id","content_hash":"7e4eb543ffa288420538482f930ea2198735c3600d3963f5c7692595b7a79220","title":"Implement cache management with --clear-cache flag","description":"Implement dual-cache system for extension_api.json at ~/.cache/gdoc/ with binary parsed cache for fast loading.","design":"## Cache Location\n- Use `known-folders` library to get cache directory\n- Cache files in `~/.cache/gdoc/`:\n  - `extension_api.json` - Raw JSON from Godot (source of truth)\n  - `extension_api.parsed` - Binary serialized parsed struct\n\n## Binary Cache Format\n```\n[0-3]   Magic \"GDOC\"\n[4-7]   Version (u32) - bump when struct layout changes\n[8-11]  Checksum/hash of JSON source (u32) - detect if JSON changed\n[12+]   Struct data dump\n```\n\n## Cache Flow\n**Normal run** (`gdoc Node2D`):\n1. Check if `.parsed` exists + valid (magic/version/checksum) → deserialize and use\n2. If `.parsed` invalid/missing, check if `extension_api.json` exists → parse it, create `.parsed`\n3. If JSON also missing → run `godot --dump-extension-api-with-docs`, save JSON, parse, create `.parsed`\n4. Only error if `godot` command not found or fails\n\n**With --clear-cache flag** (`gdoc Node2D --clear-cache`):\n1. Delete `~/.cache/gdoc/extension_api.json`\n2. Delete `~/.cache/gdoc/extension_api.parsed`\n3. Continue with normal lookup (triggers regeneration)\n4. Show \"Cache cleared, regenerating...\" message\n\n## Implementation Tasks\n- Add `known-folders` dependency to build.zig.zon\n- Implement getCacheDir() using known-folders\n- Implement binary cache format with magic header + version + checksum\n- Implement cache validation logic\n- Implement Godot execution: `godot --dump-extension-api-with-docs`\n- Implement atomic file writes (temp + rename)\n- Add --clear-cache flag handling","acceptance_criteria":"- [ ] Cache directory created at correct XDG location using known-folders\n- [ ] `extension_api.json` generated from Godot on first run if missing\n- [ ] Binary `.parsed` cache created with magic header + version + checksum\n- [ ] Cache validation detects stale/invalid cache and regenerates\n- [ ] `--clear-cache` flag deletes both cache files and regenerates\n- [ ] Errors gracefully when Godot not found and cache missing","status":"open","priority":1,"issue_type":"feature","created_at":"2025-11-14T16:06:33.344779+11:00","updated_at":"2025-11-14T16:06:33.344779+11:00","source_repo":"."}
{"id":"gdoc-42o","content_hash":"06717dc1f1631502592bbce0dac892189fd8ad37e94b6cb07151ea3e21a51027","title":"Tab completion support for shell environments","description":"Provide shell tab completion for symbol names across Bash, Zsh, Fish, and Nushell. Enable completing class names, methods, and properties interactively.","design":"## Overview\n\nEnable tab completion for gdoc symbols in multiple shells:\n- `gdoc Node\u003cTAB\u003e` → suggests `Node`, `Node2D`, `Node3D`, `NodePath`\n- `gdoc Node2D.\u003cTAB\u003e` → suggests `position`, `rotation`, `scale`, etc.\n- `gdoc Packed\u003cTAB\u003e` → suggests `PackedVectorArray`, `PackedByteArray`, etc.\n\n## Architecture\n\n**Completion Command**:\n```bash\ngdoc --complete \"Node\"\n# Outputs matching symbols (one per line):\n# Node\n# Node2D\n# Node3D\n# NodePath\n```\n\n**Shell Scripts**:\nEach shell gets a generated completion script that:\n1. Extracts current word/prefix from command line\n2. Calls `gdoc --complete \u003cprefix\u003e`\n3. Presents results to shell completion system\n\n## Shell Support\n\n1. **Bash** - Uses `complete` builtin with custom function\n2. **Zsh** - Uses `_gdoc` completion function\n3. **Fish** - Uses `complete -c gdoc` declarations\n4. **Nushell** - Uses custom completer in config.nu\n\n## Sub-issues\n\nThis epic tracks completion implementation across:\n1. Implement --complete flag (core functionality)\n2. Generate Bash completion script\n3. Generate Zsh completion script  \n4. Generate Fish completion script\n5. Add installation documentation\n\n## User Experience\n\n```bash\n# After installation\n$ source ~/.local/share/gdoc/completions/gdoc.bash  # Or add to .bashrc\n\n# Then use tab completion\n$ gdoc Pack\u003cTAB\u003e\nPackedByteArray  PackedColorArray  PackedFloat32Array  PackedVector2Array\n```","acceptance_criteria":"- [ ] --complete flag returns matching symbols for prefix\n- [ ] Bash completion script generated and works\n- [ ] Zsh completion script generated and works\n- [ ] Fish completion script generated and works\n- [ ] Documentation explains installation for each shell\n- [ ] Completes class names\n- [ ] Completes method/property names after dot notation","status":"open","priority":3,"issue_type":"epic","created_at":"2025-11-14T16:08:38.688464+11:00","updated_at":"2025-11-14T16:08:38.688464+11:00","source_repo":"."}
{"id":"gdoc-anz","content_hash":"ea3c19b70f6dadbf620d2367307eb4ec06ff859726b3020390003352c5c10c46","title":"Implement display formatting for classes and members","description":"Display documentation in terminal with formatting similar to zigdoc. Show class info with member listings, or detailed member info when looking up specific members.","design":"## Output Formats\n\n### Class Lookup (`gdoc Node2D`)\n```\nSymbol: Node2D\nCategory: class\nInherits: CanvasItem\n\nDescription:\n  A 2D game object, inherited by all 2D-related nodes. Has a position, \n  rotation, scale, and Z index.\n  \n  (rest of markdown description)\n\nProperties:\n  position\n  rotation\n  scale\n  global_position\n  global_rotation\n  z_index\n  z_as_relative\n\nMethods:\n  apply_scale\n  get_relative_transform_to_parent\n  global_translate\n  look_at\n  move_local_x\n  move_local_y\n  rotate\n  to_global\n  to_local\n  translate\n\nConstants:\n  (list if any)\n```\n\n### Member Lookup (`gdoc Node2D.position`)\n```\nSymbol: Node2D.position\nParent: Node2D\nCategory: property\nType: Vector2\n\nDescription:\n  Position, relative to the node's parent.\n```\n\n### Method Lookup (`gdoc PackedVectorArray.append`)\n```\nSymbol: PackedVectorArray.append\nParent: PackedVectorArray\nCategory: method\nSignature: void append(value: Vector2)\n\nDescription:\n  Appends an element at the end of the array.\n```\n\n## Implementation\n\n**src/root.zig** (or separate display.zig):\n```zig\npub fn lookupAndDisplay(symbol: []const u8, writer: anytype) !void {\n    const db = try loadDatabase(); // From cache\n    defer db.deinit();\n    \n    const entry = db.symbols.get(symbol) orelse {\n        try writer.print(\"Symbol not found: '{s}'\\n\", .{symbol});\n        return error.SymbolNotFound;\n    };\n    \n    try displayEntry(entry, db, writer);\n}\n\nfn displayEntry(entry: DocEntry, db: DocDatabase, writer: anytype) !void {\n    // Header\n    try writer.print(\"Symbol: {s}\\n\", .{entry.name});\n    \n    if (entry.parent_index) |idx| {\n        const parent = db.symbols.values()[idx];\n        try writer.print(\"Parent: {s}\\n\", .{parent.name});\n    }\n    \n    try writer.print(\"Category: {s}\\n\", .{@tagName(entry.kind)});\n    \n    if (entry.signature) |sig| {\n        try writer.print(\"Signature: {s}\\n\", .{sig});\n    }\n    \n    // Description (already in Markdown)\n    try writer.print(\"\\nDescription:\\n  {s}\\n\", .{entry.description});\n    \n    // Members (if class/type)\n    if (entry.members) |members| {\n        try displayMembers(members, db, writer);\n    }\n}\n\nfn displayMembers(member_indices: []usize, db: DocDatabase, writer: anytype) !void {\n    // Group by kind: properties, methods, constants, operators\n    var props = std.ArrayList(usize).init(db.allocator);\n    var methods = std.ArrayList(usize).init(db.allocator);\n    var constants = std.ArrayList(usize).init(db.allocator);\n    var operators = std.ArrayList(usize).init(db.allocator);\n    defer props.deinit();\n    defer methods.deinit();\n    defer constants.deinit();\n    defer operators.deinit();\n    \n    for (member_indices) |idx| {\n        const entry = db.symbols.values()[idx];\n        switch (entry.kind) {\n            .property =\u003e try props.append(idx),\n            .method =\u003e try methods.append(idx),\n            .constant, .enum_value =\u003e try constants.append(idx),\n            .operator =\u003e try operators.append(idx),\n            else =\u003e {},\n        }\n    }\n    \n    if (props.items.len \u003e 0) {\n        try writer.print(\"\\nProperties:\\n\", .{});\n        for (props.items) |idx| {\n            try writer.print(\"  {s}\\n\", .{db.symbols.values()[idx].name});\n        }\n    }\n    \n    if (methods.items.len \u003e 0) {\n        try writer.print(\"\\nMethods:\\n\", .{});\n        for (methods.items) |idx| {\n            try writer.print(\"  {s}\\n\", .{db.symbols.values()[idx].name});\n        }\n    }\n    \n    if (constants.items.len \u003e 0) {\n        try writer.print(\"\\nConstants:\\n\", .{});\n        for (constants.items) |idx| {\n            try writer.print(\"  {s}\\n\", .{db.symbols.values()[idx].name});\n        }\n    }\n    \n    if (operators.items.len \u003e 0) {\n        try writer.print(\"\\nOperators:\\n\", .{});\n        for (operators.items) |idx| {\n            const op = db.symbols.values()[idx];\n            try writer.print(\"  {s}\\n\", .{op.signature orelse op.name});\n        }\n    }\n}\n```\n\n## Error Handling\n\n- Symbol not found: Show error message with symbol name\n- Future: Suggest similar symbols (fuzzy matching)","acceptance_criteria":"- [ ] Class lookup displays name, category, inheritance, description\n- [ ] Class lookup lists all members grouped by kind (properties, methods, constants)\n- [ ] Property lookup shows parent, type, description\n- [ ] Method lookup shows parent, signature, description\n- [ ] Output matches zigdoc-style formatting\n- [ ] Symbol not found shows clear error message\n- [ ] Markdown descriptions display correctly in terminal","status":"open","priority":1,"issue_type":"feature","created_at":"2025-11-14T16:07:45.729809+11:00","updated_at":"2025-11-14T16:07:45.729809+11:00","source_repo":"."}
{"id":"gdoc-ifo","content_hash":"75d6c60cfda0c12fed24c95a7402209bd2eaa8d48387cd19f29bb1c764b1c372","title":"Add --godot flag for custom Godot executable path","description":"Allow users to specify custom path to Godot executable instead of relying on 'godot' being in $PATH.","design":"## CLI Interface\n\n```bash\ngdoc --godot /path/to/godot --clear-cache Node2D\ngdoc --godot ~/bin/godot4.5 Vector2\n```\n\n## Implementation\n\n**Add flag to zli command** (in buildCli):\n```zig\ntry root.addFlag(.{\n    .name = \"godot\",\n    .description = \"Path to Godot executable (default: 'godot' from PATH)\",\n    .type = .String,\n    .default_value = .{ .String = \"godot\" },\n});\n```\n\n**Update runLookup to pass godot path**:\n```zig\nfn runLookup(ctx: zli.CommandContext) !void {\n    const clear_cache = ctx.flag(\"clear-cache\", bool);\n    const godot_path = ctx.flag(\"godot\", []const u8);\n    \n    if (clear_cache) {\n        try gdoc.clearCache();\n        try ctx.writer.print(\"Cache cleared.\\n\", .{});\n    }\n    \n    const symbol = ctx.getArg(\"symbol\") orelse {\n        try ctx.command.printHelp();\n        return;\n    };\n    \n    try gdoc.lookupAndDisplay(symbol, godot_path, ctx.writer);\n}\n```\n\n**Update cache refresh function**:\n```zig\npub fn refreshCache(godot_path: []const u8, allocator: Allocator) !void {\n    const cache_dir = try getCacheDir(allocator);\n    const json_path = try std.fs.path.join(allocator, \u0026.{cache_dir, \"extension_api.json\"});\n    defer allocator.free(json_path);\n    \n    // Check if godot_path exists\n    std.fs.accessAbsolute(godot_path, .{}) catch {\n        return error.GodotNotFound;\n    };\n    \n    // Run godot --dump-extension-api-with-docs\n    const result = try std.process.Child.run(.{\n        .allocator = allocator,\n        .argv = \u0026.{ godot_path, \"--dump-extension-api-with-docs\" },\n    });\n    defer allocator.free(result.stdout);\n    defer allocator.free(result.stderr);\n    \n    if (result.term.Exited != 0) {\n        return error.GodotExecutionFailed;\n    }\n    \n    // Write stdout to json_path\n    try std.fs.cwd().writeFile(.{ \n        .sub_path = json_path, \n        .data = result.stdout \n    });\n}\n```\n\n## Error Handling\n\n- Custom path doesn't exist: `Error: Godot executable not found at '{s}'`\n- Execution fails: `Error: Failed to run Godot at '{s}'. Exit code: {d}`\n- Not executable: `Error: '{s}' is not executable`","acceptance_criteria":"- [ ] --godot flag accepts custom path\n- [ ] Default value is \"godot\" (from PATH)\n- [ ] Cache refresh uses custom godot path\n- [ ] Error if custom path doesn't exist\n- [ ] Error if godot execution fails\n- [ ] Works with relative and absolute paths","status":"open","priority":2,"issue_type":"feature","created_at":"2025-11-14T16:08:06.496841+11:00","updated_at":"2025-11-14T16:08:06.496841+11:00","source_repo":"."}
{"id":"gdoc-j9e","content_hash":"295308596f3bc59043c0866307818a973e2832fd7d0070c150d53f707d74113e","title":"Generate Zsh completion script","description":"Create Zsh completion function that integrates with gdoc --complete for interactive symbol completion.","design":"## Zsh Completion Script\n\n**Location**: `completions/_gdoc`\n\n**Script**:\n```zsh\n#compdef gdoc\n\n_gdoc() {\n    local -a completions\n    local cur\n\n    cur=\"${words[CURRENT]}\"\n\n    # If completing a flag\n    if [[ \"$cur\" == -* ]]; then\n        _arguments \\\n            '--clear-cache[Clear cached API data]' \\\n            '--godot[Path to Godot executable]:path:_files' \\\n            '--complete[Symbol prefix for completion]:prefix:' \\\n            '--help[Show help message]' \\\n            '--version[Show version]' \\\n            '*:symbol:_gdoc_symbols'\n    else\n        _gdoc_symbols\n    fi\n}\n\n_gdoc_symbols() {\n    local -a symbols\n    local prefix=\"${words[CURRENT]}\"\n    \n    # Call gdoc --complete\n    symbols=(${(f)\"$(gdoc --complete \"$prefix\" 2\u003e/dev/null)\"})\n    \n    _describe 'symbol' symbols\n}\n\n_gdoc \"$@\"\n```\n\n## Installation\n\nUsers add to their `~/.zshrc`:\n```zsh\nfpath=(~/.local/share/gdoc/completions $fpath)\nautoload -Uz compinit \u0026\u0026 compinit\n```\n\nOr install to system:\n```bash\nsudo cp completions/_gdoc /usr/share/zsh/site-functions/\n```\n\n## Testing\n\n```zsh\n# Reload completion\nautoload -U compinit \u0026\u0026 compinit\n\n# Test\ngdoc Node\u003cTAB\u003e\n# Should show Node, Node2D, Node3D, NodePath with descriptions\n```","acceptance_criteria":"- [ ] Zsh completion script created as _gdoc\n- [ ] Uses _gdoc and _gdoc_symbols functions\n- [ ] Calls gdoc --complete for symbol matching\n- [ ] Provides flag completion with descriptions\n- [ ] Works with partial symbols\n- [ ] Works for method completion after dot\n- [ ] Installation instructions documented","status":"open","priority":3,"issue_type":"task","created_at":"2025-11-14T16:09:40.746055+11:00","updated_at":"2025-11-14T16:09:40.746055+11:00","source_repo":".","dependencies":[{"issue_id":"gdoc-j9e","depends_on_id":"gdoc-x3v","type":"blocks","created_at":"2025-11-14T16:09:40.746622+11:00","created_by":"daemon"}]}
{"id":"gdoc-l6u","content_hash":"ba1ae5bec8c9c964300e53986b075a20f6b84a8387b395a2b6eb1c36a4473e5b","title":"Document shell completion installation","description":"Create documentation explaining how to install and use tab completion for Bash, Zsh, and Fish shells.","design":"## Documentation Location\n\nCreate `docs/COMPLETIONS.md` or add section to main README.\n\n## Content Structure\n\n### Overview\n- What tab completion provides\n- Which shells are supported\n- Prerequisites (gdoc must be installed and in PATH)\n\n### Installation by Shell\n\n**Bash**:\n```bash\n# Option 1: Source in shell config\necho 'source ~/.local/share/gdoc/completions/gdoc.bash' \u003e\u003e ~/.bashrc\nsource ~/.bashrc\n\n# Option 2: System-wide installation (requires sudo)\nsudo cp ~/.local/share/gdoc/completions/gdoc.bash /usr/share/bash-completion/completions/gdoc\n```\n\n**Zsh**:\n```zsh\n# Option 1: Add to fpath and enable compinit\nmkdir -p ~/.zsh/completions\ncp ~/.local/share/gdoc/completions/_gdoc ~/.zsh/completions/\necho 'fpath=(~/.zsh/completions $fpath)' \u003e\u003e ~/.zshrc\necho 'autoload -Uz compinit \u0026\u0026 compinit' \u003e\u003e ~/.zshrc\nsource ~/.zshrc\n\n# Option 2: System-wide installation\nsudo cp ~/.local/share/gdoc/completions/_gdoc /usr/share/zsh/site-functions/\n```\n\n**Fish**:\n```fish\n# Fish automatically loads from ~/.config/fish/completions/\nmkdir -p ~/.config/fish/completions\ncp ~/.local/share/gdoc/completions/gdoc.fish ~/.config/fish/completions/\n```\n\n### Usage Examples\n\n```bash\n# Complete class names\ngdoc Node\u003cTAB\u003e\n# Shows: Node, Node2D, Node3D, NodePath\n\n# Complete methods and properties\ngdoc Node2D.\u003cTAB\u003e\n# Shows: position, rotation, scale, global_position, ...\n\n# Complete with partial match\ngdoc Packed\u003cTAB\u003e\n# Shows: PackedByteArray, PackedColorArray, PackedFloat32Array, ...\n```\n\n### Troubleshooting\n\n- \"Completion not working\": Ensure gdoc is in PATH\n- \"Slow first completion\": First run generates cache\n- \"No suggestions\": Check cache with `gdoc --clear-cache`","acceptance_criteria":"- [ ] Documentation created in docs/COMPLETIONS.md or README\n- [ ] Installation instructions for Bash included\n- [ ] Installation instructions for Zsh included\n- [ ] Installation instructions for Fish included\n- [ ] Usage examples provided\n- [ ] Troubleshooting section included\n- [ ] Prerequisites clearly stated","status":"open","priority":3,"issue_type":"task","created_at":"2025-11-14T16:09:41.055602+11:00","updated_at":"2025-11-14T16:09:41.055602+11:00","source_repo":".","dependencies":[{"issue_id":"gdoc-l6u","depends_on_id":"gdoc-x3v","type":"blocks","created_at":"2025-11-14T16:09:41.05619+11:00","created_by":"daemon"}]}
{"id":"gdoc-m47","content_hash":"31df79cacb347063dd246c2f9f5fa093aa4e6b01ec4a9a637ec65714800119d8","title":"Generate Bash completion script","description":"Create Bash completion script that integrates with gdoc --complete for interactive symbol completion.","design":"## Bash Completion Script\n\n**Location**: `completions/gdoc.bash` (bundled with project)\n\n**Script**:\n```bash\n# Bash completion for gdoc\n_gdoc_complete() {\n    local cur prev words cword\n    _init_completion || return\n\n    # Get current word being completed\n    cur=\"${COMP_WORDS[COMP_CWORD]}\"\n    \n    # Check if we're completing a symbol (not a flag)\n    if [[ \"$cur\" != -* ]]; then\n        # Call gdoc --complete with current prefix\n        local completions=$(gdoc --complete \"$cur\" 2\u003e/dev/null)\n        COMPREPLY=($(comptime -W \"$completions\" -- \"$cur\"))\n    else\n        # Complete flags\n        local flags=\"--clear-cache --godot --help --version --complete\"\n        COMPREPLY=($(compgen -W \"$flags\" -- \"$cur\"))\n    fi\n}\n\ncomplete -F _gdoc_complete gdoc\n```\n\n## Installation Instructions\n\nUsers add to their `~/.bashrc`:\n```bash\nsource /path/to/gdoc/completions/gdoc.bash\n```\n\nOr install to system completion directory:\n```bash\nsudo cp completions/gdoc.bash /usr/share/bash-completion/completions/gdoc\n```\n\n## Testing\n\n```bash\n# Source the script\nsource completions/gdoc.bash\n\n# Test completion\ngdoc Node\u003cTAB\u003e\n# Should suggest: Node Node2D Node3D NodePath\n\ngdoc Node2D.\u003cTAB\u003e\n# Should suggest: Node2D.position Node2D.rotation etc.\n```","acceptance_criteria":"- [ ] Bash completion script created in completions/\n- [ ] Script uses _gdoc_complete function\n- [ ] Calls gdoc --complete for symbol completion\n- [ ] Completes flags when typing --\n- [ ] Works with partial symbol names\n- [ ] Works after dot for method completion\n- [ ] Installation instructions documented","status":"open","priority":3,"issue_type":"task","created_at":"2025-11-14T16:09:40.595571+11:00","updated_at":"2025-11-14T16:09:40.595571+11:00","source_repo":".","dependencies":[{"issue_id":"gdoc-m47","depends_on_id":"gdoc-x3v","type":"blocks","created_at":"2025-11-14T16:09:40.59689+11:00","created_by":"daemon"}]}
{"id":"gdoc-mqq","content_hash":"cad58516c94234f94fb0855f74f2dfeeaf8e70ffd993c9c4ca8173fad963fef8","title":"Parse extension_api.json into flat StringArrayHashMap","description":"Parse Godot extension API JSON into optimized lookup structure with all symbols in a flat StringArrayHashMap. Convert BBCode docs to Markdown using bbcodez.","design":"## Data Structures\n\n```zig\npub const DocDatabase = struct {\n    // ArrayHashMap: get by key OR by index\n    symbols: std.StringArrayHashMap(DocEntry),\n    allocator: Allocator,\n};\n\npub const DocEntry = struct {\n    name: []const u8,           // \"append\", \"sin\", \"Node2D\"\n    full_path: []const u8,      // \"PackedVectorArray.append\", \"Node2D\"\n    parent_index: ?usize,       // Index into symbols array, null for top-level\n    kind: EntryKind,\n    description: []const u8,    // Markdown (converted from BBCode)\n    signature: ?[]const u8,     // \"fn append(value: Variant)\"\n    members: ?[]usize,          // Indices of members (not strings)\n};\n\npub const EntryKind = enum {\n    builtin_class,\n    class,\n    method,\n    property,\n    constant,\n    enum_value,\n    global_function,\n    operator,\n};\n```\n\n## Flat Namespace Strategy\n\nAll symbols stored in single HashMap:\n- Classes: `\"PackedVectorArray\"` → class entry with `.members` list\n- Methods: `\"PackedVectorArray.append\"` → method entry with signature\n- Properties: `\"Node2D.position\"` → property entry\n- Globals: `\"sin\"` → global function (strip `@GlobalScope.` prefix)\n- Enums: `\"AESContext.Mode\"` → enum entry\n- Enum values: `\"AESContext.Mode.MODE_ECB_ENCRYPT\"` → enum value entry\n\n## @GlobalScope Handling\n\nWhen parsing JSON:\n```zig\nif (std.mem.startsWith(u8, full_name, \"@GlobalScope.\")) {\n    const key = full_name[\"@GlobalScope.\".len..];  // \"sin\"\n    // Store under \"sin\", not \"@GlobalScope.sin\"\n}\n```\n\n## BBCode to Markdown Conversion\n\n- Parse JSON\n- For each description field (BBCode)\n- Use `bbcodez` to convert to Markdown\n- Store Markdown in DocEntry\n- Godot BBCode tags: `[b]`, `[i]`, `[code]`, `[codeblock]`, `[url]`, `[param]`, etc.\n\n## Implementation Tasks\n\n- Define DocDatabase and DocEntry structs\n- Implement JSON parsing for `builtin_classes` array\n- Implement JSON parsing for `classes` array\n- Implement JSON parsing for global scope functions\n- Merge all into single StringArrayHashMap\n- Build parent_index and members relationships\n- Integrate bbcodez for BBCode → Markdown conversion\n- Write unit tests for parsing sample JSON","acceptance_criteria":"- [ ] DocDatabase struct with StringArrayHashMap implemented\n- [ ] Parses builtin_classes from JSON into HashMap\n- [ ] Parses classes from JSON into HashMap\n- [ ] Parses global functions (strips @GlobalScope prefix)\n- [ ] Parent/child relationships stored as indices\n- [ ] Members lists stored as indices (not strings)\n- [ ] All BBCode descriptions converted to Markdown using bbcodez\n- [ ] Unit tests verify parsing of sample classes/methods/properties","status":"open","priority":1,"issue_type":"feature","created_at":"2025-11-14T16:06:55.715924+11:00","updated_at":"2025-11-14T16:06:55.715924+11:00","source_repo":"."}
{"id":"gdoc-p9g","content_hash":"587f4de7d453439ea5bf0520dda9eadea0d73c34ca12546bd5e4605d3cf03b65","title":"Add GitHub API download fallback for extension_api.json","description":"Download extension_api.json from Godot's GitHub releases when Godot executable is not available. Low priority enhancement for users without Godot installed.","design":"## Use Case\n\nWhen cache doesn't exist and Godot is not installed:\n```bash\n$ gdoc Node2D\nCache not found. Godot executable not available.\nDownloading extension_api.json from GitHub (latest stable)...\n[progress indicator]\nDownloaded Godot 4.5.1 API documentation.\nParsing and caching...\nDone.\n\n\u003cshows Node2D documentation\u003e\n```\n\n## Implementation Strategy\n\n**GitHub API Endpoint**:\n```\nGET https://api.github.com/repos/godotengine/godot/releases/latest\n```\n\nResponse includes release info and assets. Need to find the correct asset URL for extension API JSON.\n\n**HTTP Client in Zig**:\n```zig\nconst std = @import(\"std\");\n\nfn downloadApiFromGitHub(allocator: Allocator) ![]u8 {\n    var client = std.http.Client{ .allocator = allocator };\n    defer client.deinit();\n    \n    // 1. Get latest release info\n    const release_url = \"https://api.github.com/repos/godotengine/godot/releases/latest\";\n    \n    var headers = std.http.Headers{ .allocator = allocator };\n    defer headers.deinit();\n    try headers.append(\"User-Agent\", \"gdoc/0.1.0\");\n    \n    var req = try client.fetch(.{\n        .location = .{ .url = release_url },\n        .headers = headers,\n    });\n    defer req.deinit();\n    \n    // 2. Parse JSON response to find extension_api.json asset\n    // Note: May not be in releases - might need to fetch from repo directly\n    \n    // 3. Download the asset\n    // 4. Return JSON content\n}\n```\n\n## Challenges\n\n- **Finding the API JSON**: It may not be in releases; might be in `doc/classes` or generated\n- **Rate limiting**: GitHub API has rate limits (60/hour unauthenticated)\n- **Version matching**: Ensure we get stable release, not pre-release\n- **Alternative locations**: May need to fetch from repo tree instead of releases\n\n## Alternative Approach\n\nIf extension_api.json is not in releases, fetch from a known stable branch:\n```\nhttps://raw.githubusercontent.com/godotengine/godot/master/doc/extension_api.json\n```\n\nOr generate URL pattern based on latest tag.\n\n## Error Handling\n\n- Network errors: \"Failed to download from GitHub: {error}\"\n- Rate limiting: \"GitHub API rate limit exceeded. Please install Godot or try again later.\"\n- Not found: \"Could not find extension_api.json in latest release\"\n\n## Future Enhancement\n\n- Add `--api-url` flag to specify custom API JSON URL\n- Cache multiple versions (Godot 4.3, 4.4, 4.5, etc.)","acceptance_criteria":"- [ ] Downloads extension_api.json from GitHub when Godot not found\n- [ ] Uses std.http.Client for HTTP requests\n- [ ] Finds correct API JSON from releases or repository\n- [ ] Shows progress/status message during download\n- [ ] Handles rate limiting gracefully\n- [ ] Handles network errors with clear messages\n- [ ] Only stable releases (not pre-releases)\n- [ ] Works without requiring Godot installation","status":"open","priority":3,"issue_type":"feature","created_at":"2025-11-14T16:10:04.447527+11:00","updated_at":"2025-11-14T16:10:04.447527+11:00","source_repo":"."}
{"id":"gdoc-pwp","content_hash":"39298a142e093b7ae40dc2cd4c78489fc2055f2b1ddcfec0ee2443c20e510490","title":"Generate Fish completion script","description":"Create Fish shell completion configuration that integrates with gdoc --complete for interactive symbol completion.","design":"## Fish Completion Script\n\n**Location**: `completions/gdoc.fish`\n\n**Script**:\n```fish\n# Fish completion for gdoc\n\n# Flag completions\ncomplete -c gdoc -l clear-cache -d 'Clear cached API data'\ncomplete -c gdoc -l godot -d 'Path to Godot executable' -r -F\ncomplete -c gdoc -l complete -d 'Symbol prefix for completion' -x\ncomplete -c gdoc -l help -d 'Show help message'\ncomplete -c gdoc -l version -d 'Show version'\n\n# Symbol completion function\nfunction __fish_gdoc_complete_symbols\n    set -l cmd (commandline -opc)\n    set -l current (commandline -ct)\n    \n    # Don't complete if we're typing a flag\n    if string match -q -- '-*' $current\n        return\n    end\n    \n    # Call gdoc --complete with current token\n    gdoc --complete \"$current\" 2\u003e/dev/null\nend\n\n# Register symbol completion\ncomplete -c gdoc -f -a '(__fish_gdoc_complete_symbols)'\n```\n\n## Installation\n\nUsers add to their Fish config:\n```fish\n# In ~/.config/fish/config.fish\nsource ~/.local/share/gdoc/completions/gdoc.fish\n```\n\nOr install to Fish completions directory:\n```bash\ncp completions/gdoc.fish ~/.config/fish/completions/\n```\n\n## Testing\n\n```fish\n# Reload completions\nsource ~/.config/fish/completions/gdoc.fish\n\n# Test\ngdoc Node\u003cTAB\u003e\n# Should show Node, Node2D, Node3D, NodePath\n\ngdoc Node2D.\u003cTAB\u003e\n# Should show Node2D.position, etc.\n```","acceptance_criteria":"- [ ] Fish completion script created as gdoc.fish\n- [ ] Declares flag completions with descriptions\n- [ ] Uses __fish_gdoc_complete_symbols function\n- [ ] Calls gdoc --complete for symbol matching\n- [ ] Works with partial symbols\n- [ ] Works for method completion after dot\n- [ ] Installation instructions documented","status":"open","priority":3,"issue_type":"task","created_at":"2025-11-14T16:09:40.902136+11:00","updated_at":"2025-11-14T16:09:40.902136+11:00","source_repo":".","dependencies":[{"issue_id":"gdoc-pwp","depends_on_id":"gdoc-x3v","type":"blocks","created_at":"2025-11-14T16:09:40.902764+11:00","created_by":"daemon"}]}
{"id":"gdoc-vzr","content_hash":"e21e7f185dfa5a37d13527398eaf08eabfa90a76759012d57573b3ae158a7ca1","title":"Ensure --help and --version flags work correctly","description":"Verify that zli's auto-generated --help and --version flags work correctly with our CLI setup.","design":"## Auto-generated by zli\n\nThe zli framework automatically provides:\n- `--help` / `-h` flag\n- `--version` flag  \n- Auto-formatted help output\n- Usage line generation\n\n## What We Provide\n\nIn `buildCli()`, we already set:\n```zig\nconst root = try zli.Command.init(writer, reader, allocator, .{\n    .name = \"gdoc\",\n    .description = \"Godot API documentation viewer\",\n    .version = .{ .major = 0, .minor = 1, .patch = 0 },\n}, runLookup);\n```\n\n## Expected Behavior\n\n```bash\n$ gdoc --help\ngdoc - Godot API documentation viewer\n\nUsage: gdoc [options] \u003csymbol\u003e\n\nFlags:\n  --clear-cache    Clear cached API data before lookup\n  --godot \u003cpath\u003e   Path to Godot executable (default: 'godot' from PATH)\n  --help, -h       Show this help message\n  --version        Show version information\n\nArguments:\n  symbol           Symbol to look up (e.g. Node2D, Node2D.position)\n```\n\n```bash\n$ gdoc --version\ngdoc v0.1.0\n```\n\n## Testing Tasks\n\n- Verify `gdoc --help` shows formatted help\n- Verify `gdoc -h` works as shorthand\n- Verify `gdoc --version` shows version\n- Verify help includes all flags and arguments\n- Verify help output is properly aligned","acceptance_criteria":"- [ ] gdoc --help displays auto-generated help\n- [ ] gdoc -h works as shorthand\n- [ ] gdoc --version displays version\n- [ ] Help output includes all flags\n- [ ] Help output includes positional arguments\n- [ ] Help text is properly formatted and aligned","status":"open","priority":3,"issue_type":"task","created_at":"2025-11-14T16:08:21.333253+11:00","updated_at":"2025-11-14T16:08:21.333253+11:00","source_repo":"."}
{"id":"gdoc-x3v","content_hash":"b669be8d1da31ae3ef64514a651cc46ede6d6b95b89c379a0a5045b56feff989","title":"Implement --complete flag for symbol prefix matching","description":"Add --complete flag that returns all symbols matching a given prefix, one per line. Foundation for shell completion scripts.","design":"## CLI Interface\n\n```bash\ngdoc --complete \"Node\"\n# Output (one per line):\nNode\nNode2D\nNode3D\nNodePath\n\ngdoc --complete \"Node2D.\"\n# Output:\nNode2D.position\nNode2D.rotation\nNode2D.scale\nNode2D.global_position\n...\n```\n\n## Implementation\n\n**Add flag to zli**:\n```zig\ntry root.addFlag(.{\n    .name = \"complete\",\n    .description = \"Return symbols matching prefix (for shell completion)\",\n    .type = .String,\n    .default_value = .{ .String = \"\" },\n});\n```\n\n**Update runLookup**:\n```zig\nfn runLookup(ctx: zli.CommandContext) !void {\n    const complete_prefix = ctx.flag(\"complete\", []const u8);\n    \n    if (complete_prefix.len \u003e 0) {\n        try gdoc.completeSymbol(complete_prefix, ctx.writer);\n        return;\n    }\n    \n    // ... rest of lookup logic\n}\n```\n\n**Implement completion logic** (in src/root.zig):\n```zig\npub fn completeSymbol(prefix: []const u8, writer: anytype) !void {\n    const db = try loadDatabase();\n    defer db.deinit();\n    \n    var matches = std.ArrayList([]const u8).init(db.allocator);\n    defer matches.deinit();\n    \n    // Iterate all symbols\n    var it = db.symbols.iterator();\n    while (it.next()) |entry| {\n        const key = entry.key_ptr.*;\n        if (std.mem.startsWith(u8, key, prefix)) {\n            try matches.append(key);\n        }\n    }\n    \n    // Sort alphabetically\n    std.mem.sort([]const u8, matches.items, {}, struct {\n        fn lessThan(_: void, a: []const u8, b: []const u8) bool {\n            return std.mem.lessThan(u8, a, b);\n        }\n    }.lessThan);\n    \n    // Output one per line\n    for (matches.items) |match| {\n        try writer.print(\"{s}\\n\", .{match});\n    }\n}\n```\n\n## Performance Consideration\n\n- Cache must be loaded for completion\n- First completion may be slow (cache generation)\n- Subsequent completions should be fast (binary cache)","acceptance_criteria":"- [ ] --complete flag accepts prefix string\n- [ ] Returns all symbols starting with prefix\n- [ ] Output is one symbol per line\n- [ ] Results are sorted alphabetically\n- [ ] Works with class names (e.g., \"Node\")\n- [ ] Works with member names (e.g., \"Node2D.\")\n- [ ] Handles empty prefix (returns all symbols)\n- [ ] Performance is acceptable for interactive use","status":"open","priority":3,"issue_type":"feature","created_at":"2025-11-14T16:08:58.899912+11:00","updated_at":"2025-11-14T16:08:58.899912+11:00","source_repo":".","dependencies":[{"issue_id":"gdoc-x3v","depends_on_id":"gdoc-42o","type":"blocks","created_at":"2025-11-14T16:08:58.901501+11:00","created_by":"daemon"}]}
{"id":"gdoc-zd9","content_hash":"c9a20de10ddd890d13b078fa12ccbbad421b57d773bfa7765613e910815a5556","title":"Implement CLI argument parsing with zli","description":"Implement command-line interface using zli v4.3.0 for parsing symbol lookups and --clear-cache flag.","design":"## CLI Interface\n\n```bash\ngdoc \u003csymbol\u003e                  # Look up symbol\ngdoc --clear-cache             # Clear cache only\ngdoc \u003csymbol\u003e --clear-cache    # Clear then lookup\ngdoc --help                    # Auto-generated help\ngdoc --version                 # Show version\n```\n\n## Dependencies\n\nAdd to `build.zig.zon`:\n```zig\n.dependencies = .{\n    .zli = .{\n        .url = \"https://github.com/xcaeser/zli/archive/v4.3.0.tar.gz\",\n        .hash = \"...\", // zig fetch will provide\n    },\n    // ... other deps\n},\n```\n\nAdd to `build.zig`:\n```zig\nconst zli = b.dependency(\"zli\", .{\n    .target = target,\n    .optimize = optimize,\n}).module(\"zli\");\n\n// Add to exe imports\n.imports = \u0026.{\n    .{ .name = \"zli\", .module = zli },\n    // ... others\n},\n```\n\n## Implementation\n\n**src/main.zig**:\n```zig\nconst std = @import(\"std\");\nconst zli = @import(\"zli\");\nconst gdoc = @import(\"gdoc\");\n\npub fn main() !void {\n    var gpa = std.heap.GeneralPurposeAllocator(.{}){};\n    defer _ = gpa.deinit();\n    const allocator = gpa.allocator();\n\n    var stdout_writer = std.fs.File.stdout().writerStreaming(\u0026.{});\n    var stdout = \u0026stdout_writer.interface;\n    \n    var buf: [4096]u8 = undefined;\n    var stdin_reader = std.fs.File.stdin().readerStreaming(\u0026buf);\n    const stdin = \u0026stdin_reader.interface;\n\n    const root = try buildCli(stdout, stdin, allocator);\n    defer root.deinit();\n\n    try root.execute(.{});\n    try stdout_writer.flush();\n}\n\nfn buildCli(writer: *Writer, reader: *Reader, allocator: Allocator) !*zli.Command {\n    const root = try zli.Command.init(writer, reader, allocator, .{\n        .name = \"gdoc\",\n        .description = \"Godot API documentation viewer\",\n        .version = .{ .major = 0, .minor = 1, .patch = 0 },\n    }, runLookup);\n\n    try root.addFlag(.{\n        .name = \"clear-cache\",\n        .description = \"Clear cached API data before lookup\",\n        .type = .Bool,\n        .default_value = .{ .Bool = false },\n    });\n\n    try root.addPositionalArg(.{\n        .name = \"symbol\",\n        .description = \"Symbol to look up (e.g. Node2D, Node2D.position)\",\n        .required = false,\n    });\n\n    return root;\n}\n\nfn runLookup(ctx: zli.CommandContext) !void {\n    const clear_cache = ctx.flag(\"clear-cache\", bool);\n    \n    if (clear_cache) {\n        try gdoc.clearCache();\n        try ctx.writer.print(\"Cache cleared.\\n\", .{});\n    }\n    \n    const symbol = ctx.getArg(\"symbol\") orelse {\n        try ctx.command.printHelp();\n        return;\n    };\n    \n    try gdoc.lookupAndDisplay(symbol, ctx.writer);\n}\n```\n\n## Auto-generated Features\n\nzli provides automatically:\n- `--help` / `-h` flag with formatted output\n- `--version` flag based on .version config\n- Aligned flag descriptions\n- Usage line generation","acceptance_criteria":"- [ ] zli v4.3.0 added as dependency in build.zig.zon\n- [ ] zli module imported in build.zig\n- [ ] CLI accepts symbol as positional argument\n- [ ] --clear-cache flag implemented\n- [ ] --help shows auto-generated help\n- [ ] --version shows version info\n- [ ] No symbol provided shows help message\n- [ ] Integrates with gdoc.lookupAndDisplay() function","status":"open","priority":1,"issue_type":"feature","created_at":"2025-11-14T16:07:19.633866+11:00","updated_at":"2025-11-14T16:07:19.633866+11:00","source_repo":"."}
